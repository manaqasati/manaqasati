<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Ù…Ù†Ø§Ù‚ØµØ© â€“ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø²ÙˆØ¯</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
<style>
:root{--p:#7c3aed;--p2:#6d28d9;--p3:#5b21b6;--p-light:#ede9fe;--p-mid:#ddd6fe;--text:#1e1b4b;--muted:#6b7280;--border:#e5e7eb;--bg:#f5f3ff;--white:#ffffff;--red:#ef4444;--red-light:#fee2e2;--green:#16a34a;--green-light:#dcfce7;--yellow:#d97706;--yellow-light:#fef3c7}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Tajawal',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
.side{width:252px;background:var(--white);border-left:1px solid var(--border);height:100vh;position:fixed;right:0;top:0;display:flex;flex-direction:column;z-index:100;box-shadow:2px 0 20px rgba(124,58,237,0.06)}
.side-head{padding:22px 18px 18px;border-bottom:1px solid var(--border)}
.logo{font-size:22px;font-weight:900;color:var(--p);margin-bottom:14px}.logo span{color:#f59e0b}
.user-pill{background:var(--p-light);border-radius:14px;padding:12px;display:flex;align-items:center;gap:10px}
.av{width:38px;height:38px;border-radius:11px;background:var(--p);color:#fff;font-size:16px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.av-name{font-size:13px;font-weight:800;color:var(--text)}.av-role{font-size:10px;color:var(--p);font-weight:600;margin-top:1px}
.nav{padding:14px 10px;flex:1}
.nav-sec{font-size:10px;font-weight:800;color:var(--muted);letter-spacing:.8px;padding:0 8px;margin:14px 0 5px;text-transform:uppercase}
.ni{display:flex;align-items:center;gap:9px;padding:10px 10px;border-radius:12px;color:var(--muted);cursor:pointer;font-size:14px;font-weight:600;border:none;background:none;width:100%;text-align:right;font-family:'Tajawal',sans-serif;margin-bottom:1px;transition:all .15s}
.ni:hover{background:var(--bg);color:var(--text)}.ni.on{background:var(--p-light);color:var(--p)}
.ni-ic{width:32px;height:32px;border-radius:9px;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:.15s}
.ni.on .ni-ic{background:var(--p)}.ni.on .ni-ic svg{stroke:#fff}
.ni-ic svg{stroke:currentColor}
.side-foot{padding:12px 18px;border-top:1px solid var(--border)}
.logoutbtn{display:flex;align-items:center;gap:8px;padding:9px 10px;border-radius:10px;color:var(--red);cursor:pointer;font-size:13px;font-weight:700;border:none;background:none;width:100%;font-family:'Tajawal',sans-serif;transition:.15s}
.logoutbtn:hover{background:var(--red-light)}
.main{margin-right:252px;min-height:100vh;display:flex;flex-direction:column}
.topbar{background:var(--white);border-bottom:1px solid var(--border);height:58px;padding:0 26px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:50}
.topbar-title{font-size:16px;font-weight:800}
.content{padding:22px 26px;flex:1}
.page{display:none}.page.on{display:block}
.mob-head{display:none;background:var(--white);border-bottom:1px solid var(--border);height:54px;padding:0 16px;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
.mob-logo{font-size:19px;font-weight:900;color:var(--p)}.mob-logo span{color:#f59e0b}
.mob-right{display:flex;align-items:center;gap:8px}
.mob-av{width:30px;height:30px;border-radius:9px;background:var(--p);color:#fff;font-size:13px;font-weight:800;display:flex;align-items:center;justify-content:center}
.mob-out{background:none;border:none;cursor:pointer;padding:6px;border-radius:8px;color:var(--muted);display:flex;align-items:center}
.bnav{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--white);border-top:1px solid var(--border);z-index:100;padding:4px 0 calc(env(safe-area-inset-bottom,0px) + 4px)}
.bnav-inner{display:flex}
.bni{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px;padding:7px 2px;border:none;background:none;cursor:pointer;font-family:'Tajawal',sans-serif;color:var(--muted);transition:.15s}
.bni .bic{width:24px;height:24px;display:flex;align-items:center;justify-content:center}
.bni .bic svg{stroke:currentColor;transition:.15s}
.bni .bt{font-size:9px;font-weight:700}
.bni.on{color:var(--p)}
.stat-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px}
.sc{background:var(--white);border:1px solid var(--border);border-radius:14px;padding:16px;display:flex;align-items:center;gap:12px;transition:.2s}
.sc:hover{border-color:var(--p-mid);box-shadow:0 4px 16px rgba(124,58,237,0.08)}
.sic{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.sic svg{stroke:var(--p)}.sic.y svg{stroke:var(--yellow)}.sic.g svg{stroke:var(--green)}.sic.pk svg{stroke:#db2777}
.sic.a{background:var(--p-light)}.sic.y{background:var(--yellow-light)}.sic.g{background:var(--green-light)}.sic.pk{background:#fce7f3}
.sn{font-size:24px;font-weight:900;color:var(--text)}.st{font-size:11px;color:var(--muted);margin-top:2px}
.hero{background:linear-gradient(135deg,var(--p),var(--p2));border-radius:18px;padding:24px 28px;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between;overflow:hidden;position:relative}
.hero::before{content:'';position:absolute;width:200px;height:200px;border-radius:50%;background:rgba(255,255,255,0.06);top:-60px;left:-40px}
.hero-t h2{font-size:18px;font-weight:800;color:#fff;margin-bottom:4px;position:relative}.hero-t p{font-size:12px;color:rgba(255,255,255,0.72);position:relative}
.hero-btn{background:#fff;color:var(--p);padding:10px 18px;border-radius:10px;font-size:13px;font-weight:800;cursor:pointer;border:none;font-family:'Tajawal',sans-serif;white-space:nowrap;transition:.15s;flex-shrink:0}
.hero-btn:hover{transform:translateY(-1px)}
.card{background:var(--white);border:1px solid var(--border);border-radius:14px;padding:18px;margin-bottom:16px}
.ch{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;padding-bottom:12px;border-bottom:1px solid var(--border)}
.ch h3{font-size:14px;font-weight:800}.ch-link{font-size:12px;color:var(--p);font-weight:700;background:none;border:none;cursor:pointer;font-family:'Tajawal',sans-serif}
.ri{border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:8px;transition:.2s}
.ri:last-child{margin-bottom:0}.ri:hover{border-color:var(--p-mid);background:var(--p-light)}
.ri-top{display:flex;align-items:flex-start;justify-content:space-between;gap:8px;margin-bottom:6px}
.ri-title{font-size:14px;font-weight:800;flex:1}
.ri-meta{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px}
.rm{font-size:11px;color:var(--muted);display:flex;align-items:center;gap:3px}
.ri-desc{font-size:12px;color:#475569;line-height:1.6;margin-bottom:10px}
.bid-btn{background:var(--p);color:#fff;padding:10px 16px;border-radius:10px;font-size:13px;font-weight:800;cursor:pointer;border:none;font-family:'Tajawal',sans-serif;width:100%;display:flex;align-items:center;justify-content:center;gap:6px;transition:.15s}
.bid-btn:hover{background:var(--p2)}
.tag{padding:3px 9px;border-radius:20px;font-size:10px;font-weight:700;display:inline-flex;align-items:center;gap:3px}
.t-p{background:var(--yellow-light);color:var(--yellow)}.t-a{background:var(--p-light);color:var(--p)}
.rating-banner{background:linear-gradient(135deg,#fffbeb,#fef3c7);border:1.5px solid #fcd34d;border-radius:14px;padding:16px 20px;margin-bottom:16px;display:flex;align-items:center;gap:16px}
.rb-big{font-size:42px;font-weight:900;color:var(--yellow);line-height:1}
.rb-stars{font-size:18px;color:#f59e0b;margin-bottom:4px}
.rb-count{font-size:12px;color:#92400e;font-weight:600}
.rev-item{border:1px solid var(--border);border-radius:12px;padding:13px;margin-bottom:8px}
.rev-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:5px}
.rev-name{font-size:13px;font-weight:800;display:flex;align-items:center;gap:5px}
.rev-stars{font-size:13px;color:#f59e0b}
.rev-req{font-size:11px;color:var(--muted);margin-bottom:4px}
.rev-comment{font-size:12px;color:#475569;line-height:1.6;font-style:italic}
.empty{text-align:center;padding:40px 20px;color:var(--muted)}
.empty-ic{width:52px;height:52px;background:var(--p-light);border-radius:14px;display:flex;align-items:center;justify-content:center;margin:0 auto 12px}
.empty-ic svg{stroke:var(--p)}
.empty h4{font-size:14px;font-weight:700;color:var(--text);margin-bottom:4px}.empty p{font-size:12px}
.loading{text-align:center;padding:28px;color:var(--muted);font-size:13px}
.overlay{display:none;position:fixed;inset:0;background:rgba(10,5,30,0.6);z-index:300;align-items:flex-end;justify-content:center;backdrop-filter:blur(8px)}
.overlay.show{display:flex}
.modal{background:var(--white);border-radius:24px 24px 0 0;width:100%;max-width:480px;max-height:92vh;overflow:hidden;display:flex;flex-direction:column}
.modal-drag{width:36px;height:4px;background:#d1d5db;border-radius:2px;margin:12px auto 0}
.modal-head{display:flex;align-items:center;justify-content:space-between;padding:14px 20px 12px;border-bottom:1px solid var(--border)}
.modal-head h3{font-size:16px;font-weight:800}
.modal-x{width:28px;height:28px;border-radius:7px;background:var(--bg);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--muted)}
.modal-body{padding:18px 20px;overflow-y:auto;flex:1}
.modal-foot{padding:12px 20px;border-top:1px solid var(--border);display:flex;gap:8px;background:var(--white)}
.fg{margin-bottom:14px}
.fg label{display:block;font-size:12px;font-weight:700;color:var(--text);margin-bottom:5px}
.fg input,.fg textarea{width:100%;padding:11px 13px;border:1.5px solid var(--border);border-radius:10px;font-family:'Tajawal',sans-serif;font-size:14px;outline:none;transition:.15s;background:var(--white)}
.fg input:focus,.fg textarea:focus{border-color:var(--p);box-shadow:0 0 0 3px rgba(124,58,237,0.08)}
.fg textarea{min-height:90px;resize:vertical}
.btn-p{flex:1;padding:12px;background:var(--p);color:#fff;border:none;border-radius:12px;font-family:'Tajawal',sans-serif;font-size:14px;font-weight:800;cursor:pointer;transition:.15s}
.btn-p:hover{background:var(--p2)}.btn-p:disabled{opacity:.5;cursor:not-allowed}
.btn-s{padding:12px 16px;background:var(--bg);color:var(--muted);border:1.5px solid var(--border);border-radius:12px;font-family:'Tajawal',sans-serif;font-size:14px;font-weight:700;cursor:pointer}
.bid-msg{padding:9px 12px;border-radius:8px;font-size:12px;font-weight:600;margin-bottom:10px;display:none}
.bid-msg.ok{background:var(--green-light);color:var(--green);display:block}
.bid-msg.err{background:var(--red-light);color:var(--red);display:block}
@media(max-width:1024px){.stat-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:768px){
  .side,.topbar{display:none}
  .main{margin-right:0}
  .mob-head{display:flex}
  .bnav{display:block}
  .content{padding:12px 14px;padding-bottom:86px}
  .stat-grid{grid-template-columns:repeat(2,1fr);gap:10px}
  .sc{padding:13px;border-radius:12px}
  .sic{width:38px;height:38px;border-radius:10px}
  .sn{font-size:20px}
  .hero{padding:18px;border-radius:14px;flex-direction:column;gap:12px;text-align:center}
  .hero-t h2{font-size:16px}
  .hero-btn{width:100%;padding:11px;justify-content:center}
  .card{border-radius:12px;padding:14px}
}
</style>
</head>
<body>
<div class="side">
  <div class="side-head">
    <div class="logo">Ù…Ù†Ø§Ù‚ØµØ©<span>.</span></div>
    <div class="user-pill">
      <div class="av" id="userAv">Ù…</div>
      <div><div class="av-name" id="userName">...</div><div class="av-role">Ù…Ø²ÙˆØ¯ Ø®Ø¯Ù…Ø©</div></div>
    </div>
  </div>
  <div class="nav">
    <div class="nav-sec">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</div>
    <button class="ni on" onclick="show('home',this,'home')">
      <div class="ni-ic"><svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg></div>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    </button>
    <button class="ni" onclick="show('available',this,'available')">
      <div class="ni-ic"><svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg></div>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
    </button>
    <button class="ni" onclick="show('mybids',this,'mybids')">
      <div class="ni-ic"><svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg></div>Ø¹Ø±ÙˆØ¶ÙŠ
    </button>
    <button class="ni" onclick="show('reviews',this,'reviews')">
      <div class="ni-ic"><svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></div>ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ
    </button>
  </div>
  <div class="side-foot">
    <button class="logoutbtn" onclick="logout()">
      <svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    </button>
  </div>
</div>
<div class="mob-head">
  <div class="mob-logo">Ù…Ù†Ø§Ù‚ØµØ©<span>.</span></div>
  <div class="mob-right">
    <div class="mob-av" id="mobAv">Ù…</div>
    <button class="mob-out" onclick="logout()"><svg width="19" height="19" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></button>
  </div>
</div>
<div class="main">
  <div class="topbar">
    <div class="topbar-title" id="pageTitle">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
  </div>
  <div class="content">
    <div class="page on" id="page-home">
      <div class="hero">
        <div class="hero-t"><h2 id="welcomeName">Ù…Ø±Ø­Ø¨Ø§Ù‹ ğŸ‘‹</h2><p>ØªØµÙØ­ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆÙ‚Ø¯Ù‘Ù… Ø¹Ø±ÙˆØ¶Ùƒ</p></div>
        <button class="hero-btn" onclick="show('available',null,'available')">ØªØµÙØ­ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
      </div>
      <div class="stat-grid">
        <div class="sc"><div class="sic a"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div><div><div class="sn" id="s-avail">0</div><div class="st">Ø·Ù„Ø¨Ø§Øª Ù…ØªØ§Ø­Ø©</div></div></div>
        <div class="sc"><div class="sic y"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg></div><div><div class="sn" id="s-bids">0</div><div class="st">Ø¹Ø±ÙˆØ¶ÙŠ</div></div></div>
        <div class="sc"><div class="sic g"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div><div><div class="sn" id="s-acc">0</div><div class="st">Ù…Ù‚Ø¨ÙˆÙ„Ø©</div></div></div>
        <div class="sc"><div class="sic pk"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></div><div><div class="sn" id="s-rat">â€“</div><div class="st">ØªÙ‚ÙŠÙŠÙ…ÙŠ</div></div></div>
      </div>
      <div class="card">
        <div class="ch"><h3>Ø¢Ø®Ø± Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h3><button class="ch-link" onclick="show('available',null,'available')">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„ â†</button></div>
        <div id="home-reqs"><div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div>
      </div>
    </div>
    <div class="page" id="page-available">
      <div class="card"><div class="ch"><h3>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h3></div><div id="all-reqs"><div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div></div>
    </div>
    <div class="page" id="page-mybids">
      <div class="card"><div class="ch"><h3>Ø¹Ø±ÙˆØ¶ÙŠ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</h3></div><div id="my-bids"><div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div></div>
    </div>
    <div class="page" id="page-reviews">
      <div id="rbanner"></div>
      <div class="card"><div class="ch"><h3>ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3></div><div id="my-revs"><div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div></div></div>
    </div>
  </div>
</div>
<div class="bnav">
  <div class="bnav-inner">
    <button class="bni on" id="bn-home" onclick="show('home',null,'home')"><div class="bic"><svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg></div><span class="bt">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></button>
    <button class="bni" id="bn-available" onclick="show('available',null,'available')"><div class="bic"><svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div><span class="bt">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span></button>
    <button class="bni" id="bn-mybids" onclick="show('mybids',null,'mybids')"><div class="bic"><svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg></div><span class="bt">Ø¹Ø±ÙˆØ¶ÙŠ</span></button>
    <button class="bni" id="bn-reviews" onclick="show('reviews',null,'reviews')"><div class="bic"><svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></div><span class="bt">ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ</span></button>
  </div>
</div>
<div class="overlay" id="bidOverlay">
  <div class="modal">
    <div class="modal-drag"></div>
    <div class="modal-head"><h3>ØªÙ‚Ø¯ÙŠÙ… Ø¹Ø±Ø¶</h3><button class="modal-x" onclick="closeBid()"><svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div>
    <div class="modal-body">
      <div class="bid-msg" id="bid-msg"></div>
      <div class="fg"><label>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­ (Ø±.Ø³) *</label><input type="number" id="b-price" placeholder="500" inputmode="numeric"></div>
      <div class="fg"><label>Ù…Ø¯Ø© Ø§Ù„ØªÙ†ÙÙŠØ° (Ø£ÙŠØ§Ù…) *</label><input type="number" id="b-days" placeholder="3" inputmode="numeric"></div>
      <div class="fg"><label>ØªÙØ§ØµÙŠÙ„ Ø¹Ø±Ø¶Ùƒ</label><textarea id="b-note" placeholder="Ø§Ø´Ø±Ø­ Ø®Ø¨Ø±ØªÙƒ ÙˆØ¹Ø±Ø¶Ùƒ..."></textarea></div>
    </div>
    <div class="modal-foot">
      <button class="btn-p" id="b-btn" onclick="submitBid()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ø±Ø¶</button>
      <button class="btn-s" onclick="closeBid()">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>
<script>
var API='https://manaqasati-production.up.railway.app';
var user=JSON.parse(localStorage.getItem('user')||'{}');
if(!user.id){location.href='auth.html';}
var selReqId=null;
var n=user.name||'Ø§Ù„Ù…Ø²ÙˆØ¯';
document.getElementById('userName').textContent=n;
document.getElementById('welcomeName').textContent='Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ '+n.split(' ')[0]+' ğŸ‘‹';
document.getElementById('userAv').textContent=n.charAt(0);
document.getElementById('mobAv').textContent=n.charAt(0);
function show(pg,el,key){
  document.querySelectorAll('.page').forEach(function(p){p.className='page';});
  document.querySelectorAll('.ni').forEach(function(m){m.className='ni';});
  document.querySelectorAll('.bni').forEach(function(m){m.className='bni';});
  document.getElementById('page-'+pg).className='page on';
  if(el)el.className='ni on';
  if(key){var b=document.getElementById('bn-'+key);if(b)b.className='bni on';}
  var t={home:'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',available:'Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©',mybids:'Ø¹Ø±ÙˆØ¶ÙŠ',reviews:'ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ'};
  document.getElementById('pageTitle').textContent=t[pg]||'';
  if(pg==='available')loadAvail();
  if(pg==='mybids')loadBids();
  if(pg==='home')loadHome();
  if(pg==='reviews')loadRevs();
  window.scrollTo(0,0);
}
function logout(){localStorage.clear();location.href='auth.html';}
function openBid(id){selReqId=id;document.getElementById('b-price').value='';document.getElementById('b-days').value='';document.getElementById('b-note').value='';document.getElementById('bid-msg').className='bid-msg';document.getElementById('bidOverlay').className='overlay show';}
function closeBid(){document.getElementById('bidOverlay').className='overlay';}
function stars(n){var s='';for(var i=1;i<=5;i++)s+=i<=n?'â˜…':'â˜†';return s;}
function reqCard(r){
  var d=r.description?'<div class="ri-desc">'+r.description.substring(0,100)+(r.description.length>100?'...':'')+'</div>':'';
  return '<div class="ri"><div class="ri-top"><div class="ri-title">'+r.title+'</div></div><div class="ri-meta">'+(r.city?'<span class="rm"><svg width="11" height="11" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/><circle cx="12" cy="10" r="3"/></svg>'+r.city+'</span>':'')+(r.category?'<span class="rm"><svg width="11" height="11" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>'+r.category+'</span>':'')+(r.budget_max?'<span class="rm"><svg width="11" height="11" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg>'+r.budget_max+' Ø±.Ø³</span>':'')+'</div>'+d+'<button class="bid-btn" onclick="openBid('+r.id+')"><svg width="13" height="13" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>ØªÙ‚Ø¯ÙŠÙ… Ø¹Ø±Ø¶</button></div>';
}
function emptyH(t,s){return '<div class="empty"><div class="empty-ic"><svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div><h4>'+t+'</h4>'+(s?'<p>'+s+'</p>':'')+'</div>';}
function errH(){return '<div class="empty"><div class="empty-ic"><svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg></div><h4>ØªØ¹Ø°Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„</h4></div>';}
function loadHome(){
  fetch(API+'/api/requests').then(function(r){return r.json();}).then(function(reqs){
    document.getElementById('s-avail').textContent=reqs.length;
    document.getElementById('home-reqs').innerHTML=reqs.length?reqs.slice(0,3).map(reqCard).join(''):emptyH('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯','');
  }).catch(function(){document.getElementById('home-reqs').innerHTML=errH();});
  fetch(API+'/api/bids').then(function(r){return r.json();}).then(function(b){
    var m=b.filter(function(x){return x.provider_id==user.id;});
    document.getElementById('s-bids').textContent=m.length;
    document.getElementById('s-acc').textContent=m.filter(function(x){return x.status==='accepted';}).length;
  }).catch(function(){});
  fetch(API+'/api/reviews/provider/'+user.id).then(function(r){return r.json();}).then(function(d){document.getElementById('s-rat').textContent=d.average>0?d.average:'â€“';}).catch(function(){});
}
function loadAvail(){
  document.getElementById('all-reqs').innerHTML='<div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
  fetch(API+'/api/requests').then(function(r){return r.json();}).then(function(r){document.getElementById('all-reqs').innerHTML=r.length?r.map(reqCard).join(''):emptyH('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯','');}).catch(function(){document.getElementById('all-reqs').innerHTML=errH();});
}
function loadBids(){
  document.getElementById('my-bids').innerHTML='<div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
  fetch(API+'/api/bids').then(function(r){return r.json();}).then(function(bids){
    var m=bids.filter(function(b){return b.provider_id==user.id;});
    if(!m.length){document.getElementById('my-bids').innerHTML=emptyH('Ù„Ù… ØªÙ‚Ø¯Ù… Ø£ÙŠ Ø¹Ø±ÙˆØ¶ Ø¨Ø¹Ø¯','ØªØµÙØ­ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆÙ‚Ø¯Ù… Ø¹Ø±Ø¶Ùƒ');return;}
    document.getElementById('my-bids').innerHTML=m.map(function(b){
      var t=b.status==='accepted'?'<span class="tag t-a"><svg width="10" height="10" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>Ù…Ù‚Ø¨ÙˆÙ„</span>':'<span class="tag t-p"><svg width="10" height="10" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Ø§Ù†ØªØ¸Ø§Ø±</span>';
      return '<div class="ri"><div class="ri-top"><div class="ri-title">Ø·Ù„Ø¨ #'+b.request_id+'</div>'+t+'</div><div class="ri-meta"><span class="rm"><svg width="11" height="11" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg>'+b.price+' Ø±.Ø³</span><span class="rm"><svg width="11" height="11" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>'+b.days+' Ø£ÙŠØ§Ù…</span></div>'+(b.note?'<div class="ri-desc">'+b.note+'</div>':'')+'</div>';
    }).join('');
  }).catch(function(){document.getElementById('my-bids').innerHTML=errH();});
}
function loadRevs(){
  document.getElementById('my-revs').innerHTML='<div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
  fetch(API+'/api/reviews/provider/'+user.id).then(function(r){return r.json();}).then(function(d){
    if(d.count>0){document.getElementById('rbanner').innerHTML='<div class="rating-banner"><div class="rb-big">'+d.average+'</div><div><div class="rb-stars">'+stars(Math.round(d.average))+'</div><div class="rb-count">'+d.count+' ØªÙ‚ÙŠÙŠÙ… Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div></div></div>';}
    else{document.getElementById('rbanner').innerHTML='';}
    if(!d.reviews||!d.reviews.length){document.getElementById('my-revs').innerHTML=emptyH('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯','Ø£ÙƒÙ…Ù„ Ø·Ù„Ø¨Ø§Øª Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ø§Øª');return;}
    document.getElementById('my-revs').innerHTML=d.reviews.map(function(r){return '<div class="rev-item"><div class="rev-top"><div class="rev-name"><svg width="12" height="12" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>'+r.client_name+'</div><div class="rev-stars">'+stars(r.rating)+'</div></div><div class="rev-req">'+r.request_title+'</div>'+(r.comment?'<div class="rev-comment">"'+r.comment+'"</div>':'')+'</div>';}).join('');
  }).catch(function(){document.getElementById('my-revs').innerHTML=errH();});
}
function submitBid(){
  var price=document.getElementById('b-price').value,days=document.getElementById('b-days').value;
  if(!price||!days){showBM('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ù…Ø¯Ø©','err');return;}
  var btn=document.getElementById('b-btn');btn.disabled=true;btn.textContent='Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
  fetch(API+'/api/bids',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({request_id:selReqId,provider_id:user.id,price:parseInt(price),days:parseInt(days),note:document.getElementById('b-note').value})})
  .then(function(r){return r.json().then(function(d){return{ok:r.ok,d:d};});})
  .then(function(r){if(r.ok){showBM('âœ“ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø±Ø¶Ùƒ','ok');setTimeout(closeBid,1400);}else{showBM(r.d.message||'Ø­Ø¯Ø« Ø®Ø·Ø£','err');}btn.disabled=false;btn.textContent='Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ø±Ø¶';})
  .catch(function(){showBM('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„','err');btn.disabled=false;btn.textContent='Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ø±Ø¶';});
}
function showBM(t,c){var e=document.getElementById('bid-msg');e.textContent=t;e.className='bid-msg '+c;}
loadHome();
</script>
</body>
</html>
